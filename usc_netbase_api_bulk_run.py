# -*- coding: utf-8 -*-
"""
Created on Wed Feb 12 16:30:33 2014

@author: ayip
"""
import pyodbc
db_user = 'XX'
db_pw = 'XX'
conn_str = 'DRIVER={SQL Server};SERVER=madb;DATABASE=AnalyticsTestDB;UID='+db_user+';PWD='+db_pw
conn = pyodbc.connect(conn_str)
cursor = conn.cursor()
metrics = ['TotalBuzz','TotalBuzzPost','PositiveSentiment','NegativeSentiment']
user = 'XX'
pw = 'XX'

import requests, simplejson as json
from requests.auth import HTTPBasicAuth
from datetime import date, datetime, timedelta
request_line = 'https://api.netbase.com:443/cb/insight-api/2/metricValues?topics='
request_line += 'USCC%20-%202014'+'&metricSeries='
request_line += '&metricSeries='.join(metrics)
request_line += '&datetimeISO=false&pretty=false&timeUnits=Day&publishedDate=2014-05-16'
request_line += '&publishedDate='+date.today().isoformat()+'&precision=LOW&realTime=false&timePeriodOffset=0m&timePeriodRounding=1m'
print request_line
j = requests.get(request_line,auth=HTTPBasicAuth(user,pw))
r = json.loads(j.text)


#r= {u'errorCode': 0, u'metrics': [{u'timeUnit': u'Day', u'columns': [u'1356998400000', u'1357084800000', u'1357171200000', u'1357257600000', u'1357344000000', u'1357430400000', u'1357516800000', u'1357603200000', u'1357689600000', u'1357776000000', u'1357862400000', u'1357948800000', u'1358035200000', u'1358121600000', u'1358208000000', u'1358294400000', u'1358380800000', u'1358467200000', u'1358553600000', u'1358640000000', u'1358726400000', u'1358812800000', u'1358899200000', u'1358985600000', u'1359072000000', u'1359158400000', u'1359244800000', u'1359331200000', u'1359417600000', u'1359504000000', u'1359590400000', u'1359676800000', u'1359763200000', u'1359849600000', u'1359936000000', u'1360022400000', u'1360108800000', u'1360195200000', u'1360281600000', u'1360368000000', u'1360454400000', u'1360540800000', u'1360627200000', u'1360713600000', u'1360800000000', u'1360886400000', u'1360972800000', u'1361059200000', u'1361145600000', u'1361232000000', u'1361318400000', u'1361404800000', u'1361491200000', u'1361577600000', u'1361664000000', u'1361750400000', u'1361836800000', u'1361923200000', u'1362009600000', u'1362096000000', u'1362182400000', u'1362268800000', u'1362355200000', u'1362441600000', u'1362528000000', u'1362614400000', u'1362700800000', u'1362787200000', u'1362873600000', u'1362960000000', u'1363046400000', u'1363132800000', u'1363219200000', u'1363305600000', u'1363392000000', u'1363478400000', u'1363564800000', u'1363651200000', u'1363737600000', u'1363824000000', u'1363910400000', u'1363996800000', u'1364083200000', u'1364169600000', u'1364256000000', u'1364342400000', u'1364428800000', u'1364515200000', u'1364601600000', u'1364688000000', u'1364770800000', u'1364857200000', u'1364943600000', u'1365030000000', u'1365116400000', u'1365202800000', u'1365289200000', u'1365375600000', u'1365462000000', u'1365548400000', u'1365634800000', u'1365721200000', u'1365807600000', u'1365894000000', u'1365980400000', u'1366066800000', u'1366153200000', u'1366239600000', u'1366326000000', u'1366412400000', u'1366498800000', u'1366585200000', u'1366671600000', u'1366758000000', u'1366844400000', u'1366930800000', u'1367017200000', u'1367103600000', u'1367190000000', u'1367276400000', u'1367362800000', u'1367449200000', u'1367535600000', u'1367622000000', u'1367708400000', u'1367794800000', u'1367881200000', u'1367967600000', u'1368054000000', u'1368140400000', u'1368226800000', u'1368313200000', u'1368399600000', u'1368486000000', u'1368572400000', u'1368658800000', u'1368745200000', u'1368831600000', u'1368918000000', u'1369004400000', u'1369090800000', u'1369177200000', u'1369263600000', u'1369350000000', u'1369436400000', u'1369522800000', u'1369609200000', u'1369695600000', u'1369782000000', u'1369868400000', u'1369954800000', u'1370041200000', u'1370127600000', u'1370214000000', u'1370300400000', u'1370386800000', u'1370473200000', u'1370559600000', u'1370646000000', u'1370732400000', u'1370818800000', u'1370905200000', u'1370991600000', u'1371078000000', u'1371164400000', u'1371250800000', u'1371337200000', u'1371423600000', u'1371510000000', u'1371596400000', u'1371682800000', u'1371769200000', u'1371855600000', u'1371942000000', u'1372028400000', u'1372114800000', u'1372201200000', u'1372287600000', u'1372374000000', u'1372460400000', u'1372546800000', u'1372633200000', u'1372719600000', u'1372806000000', u'1372892400000', u'1372978800000', u'1373065200000', u'1373151600000', u'1373238000000', u'1373324400000', u'1373410800000', u'1373497200000', u'1373583600000', u'1373670000000', u'1373756400000', u'1373842800000', u'1373929200000', u'1374015600000', u'1374102000000', u'1374188400000', u'1374274800000', u'1374361200000', u'1374447600000', u'1374534000000', u'1374620400000', u'1374706800000', u'1374793200000', u'1374879600000', u'1374966000000', u'1375052400000', u'1375138800000', u'1375225200000', u'1375311600000', u'1375398000000', u'1375484400000', u'1375570800000', u'1375657200000', u'1375743600000', u'1375830000000', u'1375916400000', u'1376002800000', u'1376089200000', u'1376175600000', u'1376262000000', u'1376348400000', u'1376434800000', u'1376521200000', u'1376607600000', u'1376694000000', u'1376780400000', u'1376866800000', u'1376953200000', u'1377039600000', u'1377126000000', u'1377212400000', u'1377298800000', u'1377385200000', u'1377471600000', u'1377558000000', u'1377644400000', u'1377730800000', u'1377817200000', u'1377903600000', u'1377990000000', u'1378076400000', u'1378162800000', u'1378249200000', u'1378335600000', u'1378422000000', u'1378508400000', u'1378594800000', u'1378681200000', u'1378767600000', u'1378854000000', u'1378940400000', u'1379026800000', u'1379113200000', u'1379199600000', u'1379286000000', u'1379372400000', u'1379458800000', u'1379545200000', u'1379631600000', u'1379718000000', u'1379804400000', u'1379890800000', u'1379977200000', u'1380063600000', u'1380150000000', u'1380236400000', u'1380322800000', u'1380409200000', u'1380495600000', u'1380582000000', u'1380668400000', u'1380754800000', u'1380841200000', u'1380927600000', u'1381014000000', u'1381100400000', u'1381186800000', u'1381273200000', u'1381359600000', u'1381446000000', u'1381532400000', u'1381618800000', u'1381705200000', u'1381791600000', u'1381878000000', u'1381964400000', u'1382050800000', u'1382137200000', u'1382223600000', u'1382310000000', u'1382396400000', u'1382482800000', u'1382569200000', u'1382655600000', u'1382742000000', u'1382828400000', u'1382918400000', u'1383004800000', u'1383091200000', u'1383177600000', u'1383264000000', u'1383350400000', u'1383436800000', u'1383523200000', u'1383609600000', u'1383696000000', u'1383782400000', u'1383868800000', u'1383955200000', u'1384041600000', u'1384128000000', u'1384214400000', u'1384300800000', u'1384387200000', u'1384473600000', u'1384560000000', u'1384646400000', u'1384732800000', u'1384819200000', u'1384905600000', u'1384992000000', u'1385078400000', u'1385164800000', u'1385251200000', u'1385337600000', u'1385424000000', u'1385510400000', u'1385596800000', u'1385683200000', u'1385769600000', u'1385856000000', u'1385942400000', u'1386028800000', u'1386115200000', u'1386201600000', u'1386288000000', u'1386374400000', u'1386460800000', u'1386547200000', u'1386633600000', u'1386720000000', u'1386806400000', u'1386892800000', u'1386979200000', u'1387065600000', u'1387152000000', u'1387238400000', u'1387324800000', u'1387411200000', u'1387497600000', u'1387584000000', u'1387670400000', u'1387756800000', u'1387843200000', u'1387929600000', u'1388016000000', u'1388102400000', u'1388188800000', u'1388275200000', u'1388361600000', u'1388448000000', u'1388534400000'], u'dataset': [{u'seriesName': u'TotalBuzz', u'set': [71.0, 154.0, 224.0, 81.0, 71.0, 95.0, 137.0, 141.0, 108.0, 199.0, 111.0, 110.0, 65.0, 58.0, 68.0, 130.0, 118.0, 100.0, 89.0, 34.0, 127.0, 190.0, 117.0, 193.0, 76.0, 80.0, 140.0, 132.0, 170.0, 158.0, 197.0, 65.0, 47.0, 131.0, 148.0, 111.0, 87.0, 100.0, 103.0, 80.0, 140.0, 208.0, 97.0, 106.0, 168.0, 123.0, 56.0, 92.0, 88.0, 122.0, 120.0, 151.0, 82.0, 54.0, 58.0, 275.0, 150.0, 107.0, 159.0, 112.0, 67.0, 40.0, 102.0, 101.0, 129.0, 105.0, 140.0, 83.0, 18.0, 80.0, 117.0, 93.0, 105.0, 207.0, 92.0, 61.0, 72.0, 118.0, 123.0, 128.0, 122.0, 58.0, 51.0, 49.0, 106.0, 104.0, 125.0, 72.0, 68.0, 40.0, 943.0, 103.0, 112.0, 102.0, 107.0, 73.0, 48.0, 106.0, 158.0, 61.0, 146.0, 134.0, 129.0, 48.0, 44.0, 132.0, 361.0, 142.0, 86.0, 131.0, 36.0, 119.0, 131.0, 243.0, 183.0, 176.0, 138.0, 69.0, 181.0, 189.0, 118.0, 149.0, 284.0, 143.0, 91.0, 103.0, 157.0, 162.0, 170.0, 111.0, 72.0, 53.0, 129.0, 118.0, 115.0, 234.0, 88.0, 79.0, 58.0, 85.0, 295.0, 180.0, 87.0, 104.0, 55.0, 76.0, 88.0, 105.0, 74.0, 101.0, 158.0, 108.0, 57.0, 216.0, 192.0, 210.0, 209.0, 116.0, 138.0, 191.0, 104.0, 175.0, 122.0, 155.0, 109.0, 61.0, 45.0, 93.0, 101.0, 155.0, 118.0, 184.0, 74.0, 78.0, 123.0, 170.0, 200.0, 271.0, 301.0, 137.0, 96.0, 198.0, 97.0, 243.0, 128.0, 158.0, 94.0, 74.0, 137.0, 184.0, 122.0, 114.0, 143.0, 62.0, 77.0, 139.0, 135.0, 233.0, 195.0, 161.0, 118.0, 128.0, 328.0, 182.0, 195.0, 248.0, 412.0, 163.0, 150.0, 203.0, 304.0, 234.0, 446.0, 201.0, 154.0, 160.0, 112.0, 183.0, 223.0, 191.0, 221.0, 119.0, 86.0, 175.0, 194.0, 189.0, 142.0, 141.0, 111.0, 99.0, 186.0, 136.0, 85.0, 104.0, 121.0, 75.0, 54.0, 114.0, 77.0, 98.0, 118.0, 172.0, 99.0, 73.0, 51.0, 111.0, 291.0, 210.0, 281.0, 55.0, 68.0, 89.0, 348.0, 242.0, 243.0, 176.0, 163.0, 179.0, 213.0, 225.0, 273.0, 301.0, 549.0, 370.0, 262.0, 321.0, 355.0, 273.0, 411.0, 208.0, 155.0, 126.0, 176.0, 240.0, 172.0, 255.0, 243.0, 196.0, 94.0, 209.0, 114.0, 176.0, 271.0, 197.0, 147.0, 102.0, 174.0, 145.0, 204.0, 137.0, 585.0, 551.0, 374.0, 339.0, 312.0, 271.0, 224.0, 204.0, 62.0, 154.0, 130.0, 277.0, 190.0, 340.0, 238.0, 134.0, 158.0, 135.0, 174.0, 497.0, 242.0, 708.0, 296.0, 261.0, 249.0, 237.0, 195.0, 386.0, 280.0, 180.0, 189.0, 164.0, 167.0, 233.0, 306.0, 223.0, 139.0, 202.0, 263.0, 485.0, 202.0, 72.0, 169.0, 123.0, 109.0, 133.0, 207.0, 186.0, 164.0, 127.0, 140.0, 123.0, 135.0, 230.0, 124.0, 290.0, 239.0, 159.0, 127.0, 130.0, 156.0, 136.0, 97.0, 80.0, 109.0, 137.0, 151.0, 87.0, 51.0, 84.0, 158.0, 77.0, 80.0, 305.0, 224.0, 0.0]}, {u'seriesName': u'TotalBuzzPost', u'set': [66.0, 129.0, 188.0, 76.0, 68.0, 85.0, 130.0, 101.0, 90.0, 156.0, 107.0, 107.0, 61.0, 56.0, 61.0, 109.0, 77.0, 96.0, 86.0, 31.0, 120.0, 127.0, 110.0, 151.0, 70.0, 71.0, 118.0, 126.0, 144.0, 128.0, 185.0, 60.0, 47.0, 98.0, 140.0, 89.0, 79.0, 100.0, 99.0, 74.0, 136.0, 194.0, 92.0, 97.0, 160.0, 113.0, 53.0, 86.0, 72.0, 94.0, 88.0, 132.0, 79.0, 47.0, 46.0, 264.0, 131.0, 86.0, 142.0, 108.0, 63.0, 39.0, 86.0, 87.0, 121.0, 96.0, 133.0, 74.0, 18.0, 74.0, 110.0, 81.0, 99.0, 200.0, 84.0, 43.0, 71.0, 105.0, 123.0, 124.0, 120.0, 57.0, 49.0, 43.0, 94.0, 101.0, 105.0, 66.0, 66.0, 38.0, 934.0, 93.0, 106.0, 95.0, 96.0, 59.0, 31.0, 99.0, 136.0, 58.0, 139.0, 130.0, 114.0, 46.0, 42.0, 118.0, 359.0, 122.0, 84.0, 120.0, 36.0, 113.0, 123.0, 235.0, 161.0, 151.0, 119.0, 57.0, 181.0, 182.0, 108.0, 137.0, 239.0, 137.0, 82.0, 96.0, 143.0, 151.0, 138.0, 97.0, 65.0, 50.0, 106.0, 108.0, 110.0, 222.0, 79.0, 67.0, 49.0, 69.0, 281.0, 169.0, 80.0, 99.0, 55.0, 71.0, 83.0, 102.0, 70.0, 98.0, 151.0, 99.0, 52.0, 204.0, 184.0, 202.0, 204.0, 116.0, 127.0, 187.0, 102.0, 173.0, 118.0, 148.0, 95.0, 60.0, 44.0, 90.0, 83.0, 145.0, 112.0, 170.0, 68.0, 77.0, 114.0, 157.0, 196.0, 262.0, 295.0, 131.0, 87.0, 183.0, 94.0, 239.0, 121.0, 140.0, 87.0, 72.0, 133.0, 170.0, 115.0, 106.0, 113.0, 57.0, 74.0, 133.0, 123.0, 228.0, 186.0, 149.0, 110.0, 123.0, 319.0, 175.0, 174.0, 239.0, 405.0, 146.0, 144.0, 196.0, 290.0, 206.0, 408.0, 188.0, 137.0, 149.0, 107.0, 170.0, 204.0, 180.0, 207.0, 112.0, 77.0, 162.0, 175.0, 171.0, 133.0, 135.0, 105.0, 86.0, 180.0, 134.0, 82.0, 84.0, 117.0, 65.0, 46.0, 110.0, 76.0, 80.0, 108.0, 148.0, 89.0, 72.0, 50.0, 105.0, 265.0, 202.0, 262.0, 50.0, 68.0, 84.0, 327.0, 226.0, 218.0, 159.0, 148.0, 157.0, 205.0, 204.0, 260.0, 284.0, 505.0, 340.0, 230.0, 288.0, 313.0, 247.0, 371.0, 193.0, 140.0, 123.0, 166.0, 208.0, 149.0, 235.0, 228.0, 191.0, 90.0, 200.0, 97.0, 147.0, 249.0, 183.0, 135.0, 97.0, 161.0, 144.0, 198.0, 129.0, 574.0, 539.0, 348.0, 329.0, 294.0, 255.0, 218.0, 185.0, 62.0, 140.0, 120.0, 264.0, 162.0, 322.0, 224.0, 133.0, 152.0, 131.0, 150.0, 445.0, 221.0, 706.0, 269.0, 251.0, 222.0, 228.0, 178.0, 347.0, 265.0, 170.0, 179.0, 159.0, 160.0, 225.0, 290.0, 187.0, 132.0, 198.0, 260.0, 450.0, 195.0, 66.0, 154.0, 117.0, 106.0, 123.0, 206.0, 173.0, 158.0, 114.0, 129.0, 114.0, 110.0, 219.0, 120.0, 280.0, 236.0, 144.0, 116.0, 127.0, 148.0, 130.0, 96.0, 66.0, 96.0, 129.0, 147.0, 84.0, 40.0, 80.0, 157.0, 73.0, 76.0, 258.0, 191.0, 0.0]}, {u'seriesName': u'PositiveSentiment', u'set': [22.0, 50.0, 61.0, 18.0, 29.0, 15.0, 36.0, 42.0, 50.0, 40.0, 4.0, 14.0, 21.0, 20.0, 46.0, 35.0, 20.0, 33.0, 25.0, 1.0, 35.0, 40.0, 11.0, 59.0, 18.0, 4.0, 24.0, 45.0, 50.0, 53.0, 76.0, 21.0, 26.0, 32.0, 52.0, 33.0, 46.0, 16.0, 16.0, 27.0, 54.0, 55.0, 46.0, 19.0, 74.0, 43.0, 23.0, 31.0, 23.0, 39.0, 14.0, 51.0, 28.0, 19.0, 4.0, 69.0, 62.0, 25.0, 22.0, 37.0, 5.0, 24.0, 16.0, 30.0, 53.0, 22.0, 34.0, 42.0, 10.0, 21.0, 23.0, 24.0, 24.0, 36.0, 1.0, 17.0, 22.0, 8.0, 32.0, 46.0, 43.0, 21.0, 25.0, 4.0, 21.0, 11.0, 26.0, 19.0, 14.0, 11.0, 54.0, 34.0, 8.0, 12.0, 13.0, 29.0, 10.0, 38.0, 30.0, 13.0, 26.0, 24.0, 11.0, 4.0, 18.0, 4.0, 43.0, 39.0, 6.0, 46.0, 10.0, 54.0, 32.0, 42.0, 54.0, 37.0, 49.0, 13.0, 29.0, 31.0, 16.0, 23.0, 75.0, 39.0, 24.0, 47.0, 24.0, 39.0, 66.0, 28.0, 26.0, 19.0, 46.0, 12.0, 20.0, 20.0, 15.0, 6.0, 18.0, 30.0, 43.0, 40.0, 30.0, 29.0, 10.0, 31.0, 10.0, 34.0, 16.0, 38.0, 44.0, 19.0, 10.0, 88.0, 18.0, 12.0, 27.0, 25.0, 25.0, 112.0, 27.0, 46.0, 14.0, 13.0, 29.0, 21.0, 10.0, 13.0, 17.0, 56.0, 66.0, 83.0, 11.0, 34.0, 29.0, 25.0, 53.0, 63.0, 82.0, 28.0, 29.0, 84.0, 30.0, 20.0, 2.0, 46.0, 7.0, 4.0, 26.0, 15.0, 37.0, 54.0, 61.0, 26.0, 18.0, 58.0, 70.0, 52.0, 46.0, 41.0, 43.0, 73.0, 50.0, 80.0, 75.0, 80.0, 82.0, 22.0, 36.0, 53.0, 127.0, 83.0, 45.0, 25.0, 34.0, 62.0, 15.0, 32.0, 60.0, 37.0, 37.0, 34.0, 9.0, 54.0, 52.0, 32.0, 33.0, 44.0, 31.0, 15.0, 14.0, 43.0, 27.0, 26.0, 34.0, 14.0, 30.0, 52.0, 15.0, 15.0, 26.0, 43.0, 13.0, 28.0, 4.0, 43.0, 57.0, 37.0, 28.0, 13.0, 11.0, 21.0, 75.0, 9.0, 39.0, 27.0, 32.0, 31.0, 48.0, 50.0, 40.0, 124.0, 110.0, 79.0, 57.0, 55.0, 90.0, 46.0, 98.0, 47.0, 24.0, 28.0, 49.0, 44.0, 46.0, 63.0, 36.0, 28.0, 12.0, 21.0, 30.0, 24.0, 60.0, 39.0, 19.0, 9.0, 33.0, 16.0, 36.0, 37.0, 69.0, 23.0, 81.0, 39.0, 29.0, 78.0, 30.0, 21.0, 10.0, 17.0, 15.0, 37.0, 24.0, 50.0, 24.0, 17.0, 10.0, 13.0, 15.0, 101.0, 15.0, 116.0, 58.0, 23.0, 44.0, 47.0, 39.0, 19.0, 37.0, 33.0, 35.0, 20.0, 25.0, 13.0, 28.0, 26.0, 46.0, 23.0, 28.0, 31.0, 45.0, 23.0, 16.0, 19.0, 44.0, 33.0, 24.0, 14.0, 57.0, 29.0, 21.0, 51.0, 74.0, 112.0, 4.0, 76.0, 80.0, 67.0, 29.0, 47.0, 53.0, 30.0, 29.0, 27.0, 21.0, 60.0, 57.0, 37.0, 10.0, 8.0, 34.0, 4.0, 21.0, 72.0, 38.0, 0.0]}, {u'seriesName': u'NegativeSentiment', u'set': [6.0, 52.0, 30.0, 24.0, 5.0, 20.0, 24.0, 27.0, 14.0, 17.0, 16.0, 3.0, 1.0, 5.0, 12.0, 21.0, 9.0, 17.0, 18.0, 1.0, 27.0, 26.0, 1.0, 19.0, 2.0, 14.0, 31.0, 3.0, 43.0, 29.0, 22.0, 2.0, 8.0, 20.0, 3.0, 9.0, 19.0, 17.0, 26.0, 25.0, 45.0, 28.0, 15.0, 2.0, 18.0, 9.0, 11.0, 12.0, 0.0, 11.0, 6.0, 4.0, 19.0, 17.0, 1.0, 17.0, 33.0, 32.0, 35.0, 11.0, 2.0, 10.0, 7.0, 13.0, 11.0, 11.0, 4.0, 28.0, 0.0, 0.0, 20.0, 12.0, 10.0, 49.0, 21.0, 7.0, 24.0, 41.0, 41.0, 10.0, 35.0, 3.0, 12.0, 10.0, 3.0, 19.0, 2.0, 10.0, 2.0, 17.0, 18.0, 3.0, 33.0, 10.0, 12.0, 14.0, 10.0, 21.0, 15.0, 10.0, 51.0, 17.0, 41.0, 3.0, 18.0, 27.0, 21.0, 25.0, 11.0, 14.0, 6.0, 21.0, 4.0, 45.0, 9.0, 25.0, 37.0, 17.0, 18.0, 12.0, 1.0, 16.0, 22.0, 13.0, 13.0, 0.0, 9.0, 13.0, 36.0, 18.0, 3.0, 2.0, 10.0, 16.0, 35.0, 75.0, 13.0, 15.0, 3.0, 7.0, 38.0, 17.0, 3.0, 22.0, 0.0, 5.0, 13.0, 20.0, 11.0, 9.0, 9.0, 13.0, 6.0, 26.0, 8.0, 5.0, 13.0, 11.0, 9.0, 12.0, 29.0, 36.0, 26.0, 21.0, 13.0, 24.0, 0.0, 13.0, 24.0, 36.0, 14.0, 21.0, 21.0, 2.0, 17.0, 19.0, 84.0, 49.0, 66.0, 27.0, 13.0, 50.0, 28.0, 7.0, 8.0, 37.0, 7.0, 19.0, 14.0, 39.0, 13.0, 14.0, 7.0, 2.0, 2.0, 33.0, 55.0, 33.0, 33.0, 19.0, 14.0, 69.0, 119.0, 45.0, 28.0, 53.0, 154.0, 34.0, 9.0, 12.0, 34.0, 31.0, 32.0, 51.0, 13.0, 29.0, 34.0, 21.0, 73.0, 33.0, 78.0, 22.0, 22.0, 39.0, 37.0, 54.0, 37.0, 27.0, 30.0, 23.0, 43.0, 35.0, 12.0, 11.0, 12.0, 23.0, 12.0, 5.0, 29.0, 11.0, 26.0, 41.0, 20.0, 19.0, 33.0, 4.0, 106.0, 20.0, 48.0, 8.0, 0.0, 28.0, 80.0, 29.0, 34.0, 12.0, 40.0, 22.0, 50.0, 43.0, 38.0, 55.0, 89.0, 33.0, 51.0, 60.0, 48.0, 49.0, 51.0, 35.0, 59.0, 31.0, 10.0, 35.0, 18.0, 51.0, 4.0, 43.0, 14.0, 40.0, 14.0, 23.0, 23.0, 26.0, 25.0, 9.0, 34.0, 29.0, 58.0, 21.0, 24.0, 16.0, 51.0, 41.0, 48.0, 42.0, 31.0, 37.0, 1.0, 27.0, 13.0, 25.0, 59.0, 106.0, 41.0, 27.0, 10.0, 21.0, 29.0, 36.0, 8.0, 34.0, 52.0, 42.0, 4.0, 41.0, 20.0, 26.0, 5.0, 19.0, 13.0, 19.0, 27.0, 19.0, 32.0, 32.0, 23.0, 51.0, 10.0, 77.0, 36.0, 12.0, 21.0, 18.0, 30.0, 22.0, 23.0, 19.0, 44.0, 13.0, 19.0, 27.0, 13.0, 26.0, 38.0, 74.0, 68.0, 9.0, 18.0, 19.0, 12.0, 29.0, 28.0, 33.0, 36.0, 9.0, 1.0, 1.0, 3.0, 3.0, 43.0, 27.0, 1.0, 25.0, 25.0, 0.0]}]}], u'endDate': u'1388534400000', u'startDate': u'1356998400000'}
#r={u'errorCode': 0, u'metrics': [{u'timeUnit': u'Day', u'columns': [u'1388534400000', u'1388620800000', u'1388707200000', u'1388793600000', u'1388880000000', u'1388966400000', u'1389052800000', u'1389139200000', u'1389225600000', u'1389312000000', u'1389398400000', u'1389484800000', u'1389571200000', u'1389657600000', u'1389744000000', u'1389830400000', u'1389916800000', u'1390003200000', u'1390089600000', u'1390176000000', u'1390262400000', u'1390348800000', u'1390435200000', u'1390521600000', u'1390608000000', u'1390694400000', u'1390780800000', u'1390867200000', u'1390953600000', u'1391040000000', u'1391126400000', u'1391212800000', u'1391299200000', u'1391385600000', u'1391472000000', u'1391558400000', u'1391644800000', u'1391731200000', u'1391817600000', u'1391904000000', u'1391990400000', u'1392076800000', u'1392163200000'], u'dataset': [{u'seriesName': u'TotalBuzz', u'set': [23.0, 150.0, 186.0, 139.0, 184.0, 187.0, 128.0, 63.0, 74.0, 68.0, 49.0, 52.0, 119.0, 100.0, 148.0, 155.0, 132.0, 148.0, 82.0, 121.0, 110.0, 84.0, 97.0, 107.0, 228.0, 480.0, 227.0, 165.0, 79.0, 92.0, 67.0, 63.0, 77.0, 106.0, 107.0, 130.0, 85.0, 132.0, 120.0, 23.0, 158.0, 153.0, 0.0]}, {u'seriesName': u'TotalBuzzPost', u'set': [22.0, 140.0, 159.0, 108.0, 156.0, 163.0, 119.0, 58.0, 57.0, 48.0, 46.0, 45.0, 106.0, 92.0, 142.0, 138.0, 101.0, 115.0, 63.0, 105.0, 104.0, 81.0, 92.0, 97.0, 211.0, 337.0, 176.0, 146.0, 61.0, 83.0, 60.0, 62.0, 73.0, 83.0, 94.0, 125.0, 77.0, 115.0, 117.0, 20.0, 138.0, 132.0, 0.0]}, {u'seriesName': u'PositiveSentiment', u'set': [3.0, 11.0, 41.0, 18.0, 38.0, 41.0, 15.0, 6.0, 17.0, 10.0, 10.0, 17.0, 12.0, 19.0, 33.0, 9.0, 34.0, 31.0, 20.0, 8.0, 25.0, 13.0, 31.0, 25.0, 38.0, 169.0, 121.0, 55.0, 36.0, 14.0, 6.0, 1.0, 11.0, 36.0, 21.0, 17.0, 33.0, 13.0, 51.0, 6.0, 37.0, 35.0, 0.0]}, {u'seriesName': u'NegativeSentiment', u'set': [1.0, 25.0, 30.0, 6.0, 33.0, 48.0, 28.0, 13.0, 27.0, 10.0, 18.0, 11.0, 25.0, 13.0, 12.0, 4.0, 34.0, 37.0, 29.0, 26.0, 21.0, 2.0, 11.0, 5.0, 24.0, 16.0, 26.0, 17.0, 16.0, 17.0, 14.0, 9.0, 10.0, 12.0, 29.0, 26.0, 22.0, 30.0, 25.0, 8.0, 1.0, 10.0, 0.0]}]}], u'endDate': u'1392163200000', u'startDate': u'1388534400000'}


dates = r['metrics'][0]['columns']              #date
buzz = r['metrics'][0]['dataset'][0]['set']    #TotalBuzz
buzzpost = r['metrics'][0]['dataset'][1]['set']    #TotalBuzzPost
pos = r['metrics'][0]['dataset'][2]['set']    #PositiveSentiment
neg = r['metrics'][0]['dataset'][3]['set']    #NegativeSentiment

for i in range(len(dates)-1):
    print i
    d = datetime.fromtimestamp(int(r['metrics'][0]['columns'][i])/1000)+timedelta(1)
    b = r['metrics'][0]['dataset'][0]['set'][i]
    bp = r['metrics'][0]['dataset'][1]['set'][i]
    p = r['metrics'][0]['dataset'][2]['set'][i]
    n = r['metrics'][0]['dataset'][3]['set'][i]
    sql_line = "insert into [dbo].[USCellular_NB] values ('"+d.strftime('%Y-%m-%d')+"','USCC - 2014',"+str(b)+','+str(bp)+','+str(p)+','+str(n)+")"
    print sql_line
    cursor.execute(sql_line)
    cursor.commit()
conn.close()
